<!DOCTYPE html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="keywords" content="" />
        <meta name="description" content="" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

        <title>PHPDocx v4.1 Tutorial - PHPDocX</title>

        <!--Fav and touch icons-->

        <!--google web font-->
        <link href='http://fonts.googleapis.com/css?family=Raleway:400,600' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css">
        
    </head>
    <body data-spy="scroll" data-target="#affix-nav">
        
        <section id="content" class="clearfix">
            <div class="container padding-general">
    <div class="row-fluid">               
        <div class="col-xs-12 col-sm-8 col-md-9 tutorial-content floatleft">                                      
            <h2 class="title">PHPDocX v4.0 Tutorial</h2>
            
            <div class="tutorial_doc1" id="one">
                <div class="subtitle">
                    <div class="tutorial_doc_title">
                        <span class="show_hide_element"></span>
                        <strong>PHPDocX installation</strong>
                    </div>
                </div>
                <div class="tutorial_info_holder">
                    <p>PHPDocX is very easy to install. Usually it is just enough to unzip the package somewhere in your server and it is (almost) ready to go.</p>
                    <p>Obviously, as you could have guessed by its name, PHPDocX requires PHP 5 to be installed in your server. Moreover the following PHP modules should be activated:</p>
                    <div class="descr">
                        <ul>
                            <li>ZipArchive</li>
                            <li>XSLT</li>
                            <li>Tidy (not strictly necessary but highly recommended)</li>
                        </ul>
                    </div>
                    <p>For your convenience we have included a PHP script in the package (directly located in the app root folder), check.php, that will check if any of the requirements are missing.</p>
                    <p>Of course, <span class="color">DO NOT FORGET</span> to include the license key:</p>
                    <div class="descr">
                        <ul>
                            <li>Download the license key from the "MyPHPDocX section" of this website.</li>
                            <li>Copy it (plain, with no other word or character) in the <strong>code</strong> option of the config/phpdocxconfig.ini file.</li>
                            <li>Include the subdomain.domain (PRO version), the domain (CORPORATE version) or the IP (ENTERPRISE version) in the <strong>value</strong> option of the config/phpdocxconfig.ini file.</li>
                        </ul>
                    </div>
                    <div class="function_signature">
                        <div class="warning-tutorial">
                            <div class="descr">
                            <ul>
                                <p class="warning-tutorial-title">WARNINGS:</p>
                                <li>The folders where your scripts are running and/or the folder where you want to store the resulting Word documents have to have writing permissions rights.</li>
                                <li>If possible, use always UTF-8 compatible editors to code your scripts or modify any script in the PHPDocX library. The final Word documents have to be UTF-8 encoded and nonUTF-8 characters may break the final document.</li>
                                <li>All the content in a .docx file is stored in XML files so you should escape certain protected characters like the ampersand symbol (write &amp;amp; instead of &).</li>
                                <li>Make sure that your web server has activated the .docx MIME type in case you want your users to download directly the resulting Word documents to the browser (if not IE will believe that your .docx is a .zip file).</li>
                            </ul>
                            </div>
                        </div>
                    </div>                            
                    <p>There is no a priori restrictions about the OS and server software as long as it may run PHP 5. That includes, of course, basically all LINUX and UNIX distributions as well as Windows and Mac OS. You may use Apache as web server or lighttp, nginX, IIS, etcetera.</p>
                    <p>PHPDocX may use external data for your reports and documents coming from virtually any data source and it is the responsability of the user to prepare it so PHPDocX can represent it adequately. PHPDocX DOES NOT require MySQL or any other specific Database software for its deployment and correct functioning.</p>
                    <p>You DO NOT need any copy of Microsoft Office Word to generate your Word documents.</p>
                    <p>PHPDocX PRO does also not need any kind of outbound connection to work so it does not depend directly of a working Internet connection or any kind of additional third party software.</p>
                </div>
            </div>

            <div class="tutorial_doc2" id="two">
                <div class="subtitle">
                    <div class="tutorial_doc_title">
                        <span class="show_hide_element"></span>
                        <strong>Creating a Word document from scratch</strong>
                    </div>
                </div>
                <div class="code_example_holder">
                    <p>Let's start with the standard "hello world" document.</p>
                    <p>The required script reads as follows:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                            require_once 'path_to_phpdocx/classes/CreateDocx.inc';
                            $docx = new CreateDocx();
                            $docx->addText('Hello world!');
                            $docx->createDocx('../word_documents/hello_world');
                            </pre>
                        </div>
                    </div>
                    <p>The first line: require_once 'path_to_phpdocx/classes/CreateDocx.inc' is a call to the main class in PHPdocX, and path_to_phpdocx has to be sustituted by the actual path to the library relative to the current script.</p>
                    <p>You can see here the final result and download the corresponding Word document :
                        <span class="icons-download-holder-tutorial">
                            <a href="files/tutorial/hello_world.docx" title="Download .docx file">
                                <img src="img/icons/doc_file.png" width="30" height="30" />
                            </a>                              
                        </span>
                    </p>
                    <p class="thumb centerer">
                        <a href="files/tutorial/hello_world_full.png" rel="lightbox" > 
                            <img class="centered" src="files/tutorial/hello_world.png" style="width: 590px; height: 133px;" />
                        </a>
                    </p>
                    <p class="marg-top-10">
                        OK, this has been simple enough but not very rewarding. Let's go one step further and introduce a little more of formatting:
                    </p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                            require_once 'path_to_phpdocx/classes/CreateDocx.inc'; 

                            $docx = new CreateDocx();
                            $text = array();
                            $text[] =
                                array(
                                'text' => 'I am going to write'
                                );
                            $text[] =
                                array(
                                'text' => ' Hello World!',
                                'b' => 'on'
                                );
                             
                            $text[] =
                                array(
                                'text' => ' using bold characters.'
                                );
                            $docx->addText($text);
                            $docx->createDocx('../word_documents/hello_world_2');
                            </pre>
                        </div>
                    </div>
                    <p>Well now this start to look a little nicer although we have still some work ahead:
                        <span class="icons-download-holder-tutorial">
                            <a href="files/tutorial/hello_world2.docx" title="Download .docx file">
                                <img src="img/icons/doc_file.png" width="30" height="30" />
                            </a>                              
                        </span>
                    </p>
                    <p class="thumb centerer">
                        <a href="files/tutorial/hello_world2_full.png" rel="lightbox" > 
                            <img class="centered" src="files/tutorial/hello_world2.png" />
                        </a>
                    </p>
                    <p class="marg-top-10">At this point one may wonder if there is a simple way to "wrap" our document in a more beautiful frame including, for example, headers and footers and even a first page.</p>
                    <p>There are quite a few ways to do so:</p>
                    <div class="descr">
                        <ul>
                            <li>Importing the headers and footers from an existing Word document.</li>
                            <li>Creating your own headers and footers via the addheader and addFooter methods.</li>
                            <li>Using a different base template with all the required formatting.</li>
                            <li>Using a custom template.</li>
                        </ul>
                    </div>                            
                    <p>Like we have not yet talked about templates (base or custom) and the addHeader and addFooter methods required of certain concepts not yet introduced, we will restrict ourselves,by the time being (please, be patient), to the first of the available options.</p>
                    <p>We have already prepared a standard Word document (.docx, of course) with a nice header and footer that we would like to insert in our current document. Its relative path to this script is, for example, resources/niceHeaderAndFooter.docx.</p>
                    <p>So let's proceed:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                            require_once 'path_to_phpdocx/classes/CreateDocx.inc';

                            $docx = new CreateDocx();
                             
                            //Importing header and footer from external .docx file
                            $docx ->importHeadersAndFooters('../word_documents/templateHeaderAndFooter.docx');
                            $text = array();
                            $text[] =
                                        array(
                                        'text' => 'I am going to write'
                                        );
                            $text[] =
                                        array(
                                        'text' => ' Hello World!',
                                        'b' => 'on'
                                        );
                             
                            $text[] =
                                        array(
                                        'text' => ' using bold characters.'
                                        );
                            $docx->addText($text);
                             
                            $docx->createDocx('../word_documents/hello_world_headersAndFooters');

                            </pre>
                        </div>
                    </div>
                    <p>
                        <span class="title_code_example">
                            This is definitely starting to look much nicer:
                        </span>
                        <span class="icons-download-holder-tutorial">
                            <a href="files/tutorial/hello_world_headersAndFooters.docx" title="Download .docx file">
                                <img src="img/icons/doc_file.png" width="30" height="30" />
                            </a>                              
                        </span>
                    </p>
                    <p class="thumb centerer">
                        <a href="files/tutorial/hello_world_headersAndFooters_full.png" rel="lightbox" > 
                            <img class="centered" src="files/tutorial/hello_world_headersAndFooters.png" />
                        </a>
                    </p>
                    <p class="marg-top-10">If you prefer only to import the header you may have used:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                            $docx ->importHeadersAndFooters('../word_documents/templateHeaderAndFooter.docx', 'header');
                            </pre>
                        </div>
                    </div>
                    <p>and equivalently</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                            $docx ->importHeadersAndFooters('../word_documents/templateHeaderAndFooter.docx', 'footer');
                            </pre>
                        </div>
                    </div>
                    <p>if you only wish to import the footer.</p>
                    <p>The footers and headers can include photos, tables, standard text, lists, links, shapes, etcetera. The import procedure also preserves the display properties of the headers and footers (first, even and odd pages).</p>
                    <p>Now to continue we are going to populate our word document with a series of standard objects:</p>
                    <div class="descr">
                        <ul>
                            <li>Lists</li>
                            <li>Tables</li>
                            <li>Images</li>
                            <li>Charts</li>
                        </ul>
                    </div> 
                    <p>There are many other possibilities but we prefer to refer to the documentation for a complete set of examples in order not to clutter this tutorial with unneeded details.</p>
                    <p>Let us first include a simple unordered nested list after our "hello world" paragraph. In order to do so we should use the addList method:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                            //Call to PHPDocX
                            require_once 'path_to_phpdocx/classes/CreateDocx.inc';
                             
                            $docx = new CreateDocx();
                             
                            //Importing header and footer from external .docx file
                            $docx ->importHeadersAndFooters('../word_documents/templateHeaderAndFooter.docx');
                             
                            $text = array();
                            $text[] =
                                        array(
                                        'text' => 'I am going to write'
                                        );
                            $text[] =
                                        array(
                                        'text' => ' Hello World!',
                                        'b' => 'on'
                                        );
                            $text[] =
                                        array(
                                        'text' => ' using bold characters.'
                                        );
                            //We insert the the text into the Word document
                            $docx->addText($text);
                             
                            //Let us now to add a nested unordered list
                            $myList = array('item 1',
                                        'item 2',
                                        array('subitem 2_1',
                                            'subitem 2_2'),
                                        'item 3',
                                        array('subitem 3_1',
                                            'subitem 3_2',
                                            array('sub_subitem 3_2_1',
                                                'sub_subitem 3_2_1')),
                                        'item 4');
                             
                            $docx->addList($myList, 1);
                             
                            $docx->createDocx('../word_documents/hello_world_list');

                            </pre>
                        </div>
                    </div>
                    <p>What we get looks like this:
                        <span class="icons-download-holder-tutorial">
                            <a href="files/tutorial/hello_world_list.docx" title="Download .docx file">
                                <img src="img/icons/doc_file.png" width="30" height="30" />
                            </a>                              
                        </span>
                    </p>
                    <p class="thumb centerer">
                        <a href="files/tutorial/hello_world_list_full.png" rel="lightbox" > 
                            <img class="centered" src="files/tutorial/hello_world_list.png" />
                        </a>
                    </p>
                    <p class="marg-top-10">If you had choosen the second parameter to be 2 instead of 1 you would have got a standard numbered list. Now you may wonder:</p>
                    <div class="descr">
                        <ul>
                            <li>How can I get more sophisticated list styles?</li>
                            <li>How can I insert something more than plain text as an item for a list?</li>
                        </ul>
                    </div>
                    <p>The answer to the first question is pretty simple: you may run the parseStyles() method (<a href="http://www.phpdocx.com/documentation/examples/easy/parseStyles.php" target="_blank">see example</a>) in a separate script and generate a Word document with all the info about the list, paragraph and table styles that are available by default. We will see later that if you choose to use your own "base template" you may incorporate all the styles you wish. You may also use the createListStyle method to generate your own list styles in execution time.</p>
                    <p>The answer to the second question is a little more elaborate but still simple enough: you should create a Word fragment to achieve more sophisticated formatting:</p>
                    <p>The corresponding code reads:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                            //Call to PHPDocX
                            require_once 'path_to_phpdocx/classes/CreateDocx.inc';
                             
                            $docx = new CreateDocx();
                             
                            //Importing header and footer from external .docx file
                            $docx ->importHeadersAndFooters('../word_documents/templateHeaderAndFooter.docx');
                             
                            $text = array();
                                $text[] =
                                array(
                                'text' => 'I am going to write'
                                );
                            $text[] =
                                array(
                                'text' => ' Hello World!',
                                'b' => 'on'
                                );
                            $text[] =
                                array(
                                'text' => ' using bold characters.'
                                );
                            //We insert the the text into the Word document
                            $docx->addText($text);
                            //we prepare some formatted text for insertion in the list
                            $myItem = new WordFragment($docx);
                            $newText = array(
                                array(
                                    'text' => 'This is the text associated with the first item',
                                    'b' => 'on',
                                    'color' => 'b70000'
                                ),
                                array(
                                    'text' => ' now without bold'
                                ),
                                array(
                                    'text' => ' and blue',
                                    'color' => '0000b7'
                                )
                            );                            
                            $myItem->addText($newText);
                             
                            //Let us now include the Word fragment in a sample list
                            $myList = array($myItem,
                                'item 2',
                                array('subitem 2_1',
                                    'subitem 2_2'),
                                'item 3',
                                array('subitem 3_1',
                                    'subitem 3_2',
                                    array('sub_subitem 3_2_1',
                                        'sub_subitem 3_2_1')),
                                'item 4');
                             
                            $docx->addList($myList, array('val' => 1));
                             
                            $docx->createDocx('../word_documents/hello_world_list2');
                            </pre>
                        </div>
                    </div>
                    <p>And you get:
                        <span class="icons-download-holder-tutorial">
                            <a href="files/tutorial/hello_world_list2.docx" title="Download .docx file">
                                <img src="img/icons/doc_file.png" width="30" height="30" />
                            </a>                              
                        </span>
                    </p>
                    <p class="thumb centerer">
                        <a href="files/tutorial/hello_world_list2_full.png" rel="lightbox" > 
                            <img class="centered" src="files/tutorial/hello_world_list2.png" />
                        </a>
                    </p>
                    <p class="marg-top-10">This way to insert elements one within the other may be extended to other cases in a simple way:</p>
                    <div class="descr">
                        <ul>
                            <li>Create a new Word Fragment (WordFragment class).</li>
                            <li>Include all the required content into the Word fragment with standard PHPDocX methods.</li>
                            <li>Insert the resulting Word fragment:
                                <ul>
                                    <li>within a table,</li>
                                    <li>within a list (only inline content),</li>
                                    <li>anywhere in the Word document with the insertWordFragmentBefore/After methods,</li>
                                    <li>or in the headers and footers via the addHeader and addFooter methods.</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <p>Now we will try to insert a simple table so our Word document gets richer in contents.</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                            //Call to PHPDocX
                            require_once 'path_to_phpdocx/classes/CreateDocx.inc';
                             
                            $docx = new CreateDocx();
                             
                            //Importing header and footer from external .docx file
                            $docx ->importHeadersAndFooters('../word_documents/templateHeaderAndFooter.docx');
                             
                            $text = array();
                            $text[] =
                                array(
                                'text' => 'I am going to write'
                                );
                            $text[] =
                                array(
                                'text' => ' Hello World!',
                                'b' => 'on'
                                );
                            $text[] =
                                array(
                                'text' => ' using bold characters.'
                                );
                            //We insert the the text into the Word document
                            $docx->addText($text);
                             
                            //we prepare some formatted text for insertion in the list
                            $myItem = new WordFragment($docx);
                            $newText = array(
                                array(
                                    'text' => 'This is the text associated with the first item',
                                    'b' => 'on',
                                    'color' => 'b70000'
                                ),
                                array(
                                    'text' => ' now without bold'
                                ),
                                array(
                                    'text' => ' and blue',
                                    'color' => '0000b7'
                                )
                            );                            
                            $myItem->addText($newText);
                             
                            //Let us now include the Word fragment in a sample list
                            $myList = array($myItem,
                                'item 2',
                                array('subitem 2_1',
                                    'subitem 2_2'),
                                'item 3',
                                array('subitem 3_1',
                                    'subitem 3_2',
                                    array('sub_subitem 3_2_1',
                                        'sub_subitem 3_2_1')),
                                'item 4');
                             
                            $docx->addList($myList, array('val' => 1));
                             
                            $tableData = array(
                                array(
                                'cell_1_1',
                                'cell_1_2',
                                'cell_1_3',
                                'cell_1_4'
                                ),
                                array(
                                'cell_2_1',
                                'cell_2_2',
                                'cell_2_3',
                                'cell_2_4'
                                ),
                                array(
                                'cell_3_1',
                                'cell_3_2',
                                'cell_3_3',
                                'cell_3_4'
                                )
                            );
                             
                            $tableProperties = array(
                                'border' => 'single',
                                'borderWidth' => 10//in eights of a point
                                );
                             
                            $docx->addTable($tableData, $tableProperties);
                             
                            $docx->createDocx('../word_documents/example_table');
                            </pre>
                        </div>
                    </div>
                    <p>And you get:
                        <span class="icons-download-holder-tutorial">
                            <a href="files/tutorial/example_table.docx" title="Download .docx file">
                                <img src="img/icons/doc_file.png" width="30" height="30" />
                            </a>                              
                        </span>
                    </p>
                    <p class="thumb centerer">
                        <a href="files/tutorial/example_table_full.png" rel="lightbox" > 
                            <img class="centered" src="files/tutorial/example_table.png" />
                        </a>
                    </p>
                    <p class="marg-top-10">This is certainly not the most beautiful table you have ever seen but we can solve that problem pretty easily by having a look at the available table styles in the document that we have generated before with the parseStyles() method.</p>
                    <p>For example we may use the "MediumGrid3-accent5PHPDOCX" accent table style (blame Word for the funky names):</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                            /Call to PHPDocX
                            require_once 'path_to_phpdocx/classes/CreateDocx.inc';
                             
                            $docx = new CreateDocx();
                             
                            //Importing header and footer from external .docx file
                            $docx ->importHeadersAndFooters('../word_documents/templateHeaderAndFooter.docx');
                            $text = array();
                            $text[] =
                                array(
                                'text' => 'I am going to write'
                                );
                            $text[] =
                                array(
                                'text' => ' Hello World!',
                                'b' => 'on'
                                );
                             
                            $text[] =
                                array(
                                'text' => ' using bold characters.'
                                );
                            $docx->addText($text);
                             
                            //we prepare some formatted text for insertion in the list
                            $myItem = new WordFragment($docx);
                            $newText = array(
                                array(
                                    'text' => 'This is the text associated with the first item',
                                    'b' => 'on',
                                    'color' => 'b70000'
                                ),
                                array(
                                    'text' => ' now without bold'
                                ),
                                array(
                                    'text' => ' and blue',
                                    'color' => '0000b7'
                                )
                            );                            
                            $myItem->addText($newText);
                             
                            //Let us now include the Word fragment in a sample list
                            $myList = array($myItem,
                                'item 2',
                                array('subitem 2_1',
                                    'subitem 2_2'),
                                'item 3',
                                array('subitem 3_1',
                                    'subitem 3_2',
                                    array('sub_subitem 3_2_1',
                                        'sub_subitem 3_2_1'))
                                'item 4');
                             
                            $docx->addList($myList, array('val' => 1));
                             
                            $tableData = array(
                                array(
                                    'cell_1_1',
                                    'cell_1_2',
                                    'cell_1_3',
                                    'cell_1_4'
                                ),
                                array(
                                    'cell_2_1',
                                    'cell_2_2',
                                    'cell_2_3',
                                    'cell_2_4'
                                ),
                                array(
                                    'cell_3_1',
                                    'cell_3_2',
                                    'cell_3_3',
                                    'cell_3_4'
                                )
                            );
                             
                            $tableProperties = array('tableStyle' => 'MediumGrid3-accent5PHPDOCX');
                             
                            $docx->addTable($tableData, $tableProperties);
                             
                            $docx->createDocx('../word_documents/example_table_style');
                            </pre>
                        </div>
                    </div>
                    <p>This certainly looks much nicer and pretty simple to implement:
                        <span class="icons-download-holder-tutorial">
                            <a href="files/tutorial/example_table_style.docx" title="Download .docx file">
                                <img src="img/icons/doc_file.png" width="30" height="30" />
                            </a>                              
                        </span>
                    </p>
                    <p class="thumb centerer">
                        <a href="files/tutorial/example_table_style_full.png" rel="lightbox" > 
                            <img class="centered" src="files/tutorial/example_table_style.png" />
                        </a>
                    </p>
                    <p class="marg-top-10">Although this example clearly does not exhaust all the table formatting capabilities of PHPDocX we leave the nitty-gritty details to the addTable method API documentation.</p>
                    <p>But one always want something more and eventually one may need to insert tables with "rowspans" and "colspans". What can we do about that?</p>
                    <p>The simplest way (although not the only one) to do that it is to parse an HTML table and associate a Word style to it.</p>
                    <p>Like our script is starting to get a little lengthly let us concentrate only in the relevant part of it. Let's define a $myTable variable as follows:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                            $myHTML = '<br /><p>We include a table with rowspans and colspans using the embedHTML method.</p>
                            <table>
                                <tr>
                                    <td>header 1</td>
                                    <td>header 2</td>
                                    <td>header 3</td>
                                    <td>header 4</td>
                                </tr>
                                <tr>
                                    <td rowspan="2" colspan="2">cell_1_1</td>
                                    <td>cell_1_3</td>
                                    <td>cell_1_4</td>
                                </tr>
                                <tr>
                                    <td>cell_2_3</td>
                                    <td>cell_2_4</td>
                                </tr>
                                <tr>
                                    <td>cell_3_1</td>
                                    <td>cell_3_2</td>
                                    <td>cell_3_3</td>
                                    <td>cell_3_4</td>
                                </tr>
                            </table>';
                            $docx->embedHTML($myHTML, array('WordStyles' => array('&lt;table>' => 'MediumGrid3-accent5PHPDOCX'));
                            </pre>
                        </div>
                    </div>
                    <p>This should render a table like this:
                        <span class="icons-download-holder-tutorial">
                            <a href="files/tutorial/example_table_style_HTML.docx" title="Download .docx file">
                                <img src="img/icons/doc_file.png" width="30" height="30" />
                            </a>                              
                        </span>
                    </p>
                    <p class="thumb centerer">
                        <a href="files/tutorial/example_table_style_HTML_full.png" rel="lightbox" > 
                            <img class="centered" src="files/tutorial/example_table_style_HTML.png" />
                        </a>
                    </p>                    
                    <p class="marg-top-10">By the way, if you do not like the styles that come bundled with PHPDocX (basically the quick styles that come with the standard Word 2007 distribution) you may import custom styles from other Word document using the importStyles() method or by using your own base template.</p>
                    <p>
                        <div class="warning-tutorial marg-top-10">
                            <div class="descr">
                                <ul>
                                    <p class="warning-tutorial-title">WARNINGS:</p>
                                    <li>If you use px instead of pt as your CSS units take into account a 0.75 relative scale factor</li>
                                </ul>                                
                            </div>
                        </div>
                    </p>
                    <p>As you can foresee the embedHTML method may have multiple uses but for the sake of brevity we will ignore them by the time being and we will move forward to investigate how to include images and charts.</p>
                    <p>To insert an image is as simple as this:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                            $paramsImg = array(
                                'src' => '../img/image.png',//path to the image that we would like to insert
                                'scaling' => 90,//scaling factor, 100 corresponds to no scaling
                                'spacingTop' => 10,//top padding
                                'spacingBottom' => 10,//bottom padding
                                'spacingLeft' => 10,//left padding
                                'spacingRight' => 10,//right padding
                                'textWrap' => 1//corresponding to square format
                            );
                            $docx->addImage($paramsImg);
                            </pre>
                        </div>
                    </div>
                    <p>This should render an image like this:
                        <span class="icons-download-holder-tutorial">
                            <a href="files/tutorial/example_image.docx" title="Download .docx file">
                                <img src="img/icons/doc_file.png" width="30" height="30" />
                            </a>                              
                        </span>
                    </p>
                    <p class="thumb centerer">
                        <a href="files/tutorial/example_image_full.png" rel="lightbox" > 
                            <img class="centered" src="files/tutorial/example_image.png" />
                        </a>
                    </p>
                    <p class="marg-top-10">If you need to include more than one photo with a precise layout you may combine the addTable method with createWordMLFragment to generate the desired ouput. For example:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                            $text = 'We are going to locate three pictures in a row just below this text. And we are going to use Trebuchet MS font to change a little bit :-)';

                            $paramsText = array(
                                'font' => 'Trebuchet MS'
                            );

                            $docx->addText($text, $paramsText);

                            $images = array('aeg.png','aeg.png','aeg.png');
                            $wordImages = array();

                            foreach ($images as $image) {
                                $paramsImg = array(
                                    'src' => $image,//The image to be inserted
                                    'dpi' => 120,//We force the images to a 100 dpi resolution
                                    'scaling' => 90,//We scale them at 90% size
                                    'spacingTop' => 10,//top padding
                                    'spacingBottom' => 10,//bottom padding
                                    'spacingLeft' => 10,//left padding
                                    'spacingRight' => 10,//right padding
                                    'textWrap' => 1,//corresponding to square format
                                    'rawWordML' => true//The result will be stored in a WordML fragment
                                );
                                $imageFragment = new WordFragment($docx);
                                $imageFragment->addImage($paramsImg);
                                array_push($wordImages, $imageFragment);

                            }
                            $paramsTable = array(
                                'tableStyle' => 'NormalTablePHPDOCX',
                            );
                            $values = array($wordImages);
                            $docx->addTable($values, $paramsTable);
                            </pre>
                        </div>
                    </div>
                    <p>This should now render the three inserted image like this:
                        <span class="icons-download-holder-tutorial">
                            <a href="files/tutorial/example_image_table.docx" title="Download .docx file">
                                <img src="img/icons/doc_file.png" width="30" height="30" />
                            </a>                              
                        </span>
                    </p>
                    <p class="thumb centerer">
                        <a href="files/tutorial/example_image_table_full.png" rel="lightbox" > 
                            <img class="centered" src="files/tutorial/example_image_table.png" />
                        </a>
                    </p>
                    <p class="marg-top-10">To finish with the most basic functionality of PHPDocX we are going now to insert a chart.</p>
                    <p>PHPDocX virtually allows to include any chart that can be included through the standard Word interface:</p>
                    <div class="descr">
                        <ul>
                            <li>2D and 3D pie charts,</li>
                            <li>2D and 3D bar graphs,</li>
                            <li>2D and 3D col bars,</li>
                            <li>2D and 3D area charts,</li>
                            <li>2D and 3D line charts,</li>
                            <li>2D and 3D surface charts,</li>
                            <li>2D and 3D bubble charts,</li>
                            <li>radar charts,</li>
                            <li>donought charts,</li>
                            <li>scatter charts.</li>
                        </ul>
                    </div>
                    <p>As an example we will include a radar type chart:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                            $legends = array(
                                'legend' => array('sequence 1', 'sequence 2', 'sequence 3'),
                                'Category 1' => array(9.3, 2.4, 2),
                                'Category 2' => array(8.5, 4.4, 1),
                                'Category 3' => array(6.5, 1.8, 0.5),
                                'Category 4' => array(8.5, 3, 1),
                                'Category 5' => array(6, 5, 2.6)
                            );
                            $args = array(
                                'data' => $legends,
                                'type' => 'radar',
                                'style' => 'radar',
                                'title' => 'Radar chart',
                                'sizeX' => 15, 
                                'sizeY' => 15,
                                'legendpos' => 't',
                                'border' => 1,
                                'vgrid' => 1
                            );
                            $docx->addChart($args);
                            </pre>
                        </div>
                    </div>
                    <p>And you get:
                        <span class="icons-download-holder-tutorial">
                            <a href="files/tutorial/example_radar_chart.docx" title="Download .docx file">
                                <img src="img/icons/doc_file.png" width="30" height="30" />
                            </a>                              
                        </span>
                    </p>
                    <p class="thumb centerer">
                        <a href="files/tutorial/example_radar_chart_full.png" rel="lightbox" > 
                            <img class="centered" src="files/tutorial/example_radar_chart.png" />
                        </a>
                    </p>
                    <p class="marg-top-10">In order to see all the available options you should visit the Full reference Documentation, nevertheless to illustrate the flexibility of PHPDocX you may easily create a bar chart with the associated data data table just by setting the 'showtable' option to 1 and setting the type to "colBar":</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                                $legends = array(
                                    'legend' => array('sequence 1', 'sequence 2', 'sequence 3'),
                                    'Category 1' => array(9.3, 2.4, 2),
                                    'Category 2' => array(8.5, 4.4, 1),
                                    'Category 3' => array(6.5, 1.8, 0.5),
                                    'Category 4' => array(8.5, 3, 1),
                                    'Category 5' => array(6, 5, 2.6)
                                );
                                $args = array(
                                    'data' => $legends,
                                    'type' => 'colBar',
                                    'title' => 'Chart with table',
                                    'sizeX' => 15, 'sizeY' => 15,
                                    'legendpos' => 't',
                                    'border' => 1,
                                    'vgrid' => 1,
                                    'showtable' => 1
                                );
                                $docx->addChart($args);
                            </pre>
                        </div>
                    </div>
                    <p>So this time we will obtain:
                        <span class="icons-download-holder-tutorial">
                            <a href="files/tutorial/example_chart_showtable.docx" title="Download .docx file">
                                <img src="img/icons/doc_file.png" width="30" height="30" />
                            </a>                              
                        </span>
                    </p>
                    <p class="thumb centerer">
                        <a href="files/tutorial/example_chart_showtable_full.png" rel="lightbox" > 
                            <img class="centered" src="files/tutorial/example_chart_showtable.png" />
                        </a>
                    </p>
                    <h3 class="marg-top-10"><span class="color">Using your own base template and setting up general config options</span></h3>
                    <p>We have already commented that PHPDocX users may use their own "base templates" in order to generate their custom documents or reports.</p>
                    <p>The procedure is quite simple. One only has to make a call to the desired template whenever a new docx is created:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                                require_once 'path_to_phpdocx/classes/CreateDocx.inc';
                                $docx = new CreateDocx('../word_documents/numberedHeadings.docx');//You should include the path to your base template
                                $docx->addText('This is a numbered Heading', array('pStyle' => 'Heading1PHPDOCX'));
                                $docx->addText('Hello world again!');
                                $docx->addText('This is a  Subheading', array('pStyle' => 'Heading2PHPDOCX'));
                                $docx->addText('No more Hello world, please!');
                                $docx->createDocx('../word_documents/new_baseTemplate');

                            </pre>
                        </div>
                    </div>
                    <p>As you may see from the result:
                        <span class="icons-download-holder-tutorial">
                            <a href="files/tutorial/new_baseTemplate.docx" title="Download .docx file">
                                <img src="img/icons/doc_file.png" width="30" height="30" />
                            </a>                              
                        </span>
                    </p>
                    <p class="thumb centerer">
                        <a href="files/tutorial/new_baseTemplate_full.png" rel="lightbox" > 
                            <img class="centered" src="files/tutorial/new_baseTemplate.png" />
                        </a>
                    </p>
                    <p class="marg-top-10">You may get customized headers and footers as well as many other configuration options in just one shot.</p>
                    <p>For example you may also include a "front page" as structured content that will be preserved by PHPDocX:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                                require_once 'path_to_phpdocx/classes/CreateDocx.inc';
                                $docx = new CreateDocx('../word_documents/frontPageTemplate.docx');//You should include the path to your base template

                                $docx->addText('This is a numbered Heading', array('pStyle' => 'Heading1PHPDOCX'));
                                $docx->addText('Hello world again!');
                                $docx->addText('This is a  Subheading', array('pStyle' => 'Heading2PHPDOCX'));
                                $docx->addText('No more Hello world, please!');
                                $docx->createDocx('../word_documents/front_page');;

                            </pre>
                        </div>
                    </div>
                    <p>So we get:
                        <span class="icons-download-holder-tutorial">
                            <a href="files/tutorial/front_page.docx" title="Download .docx file">
                                <img src="img/icons/doc_file.png" width="30" height="30" />
                            </a>                              
                        </span>
                    </p>
                    <p class="thumb centerer">
                        <a href="files/tutorial/front_page_full.png" rel="lightbox" > 
                            <img class="centered" src="files/tutorial/front_page.png" />
                        </a>
                    </p>
                    <p class="marg-top-10">Nevertheles to use the default template may show convenient because it has been prepared to have available all the standard Word style options.</p>
                    <p>If you use your own template make sure, by using the parseStyles() method that you have enough styles at your disposal.</p>
                    <div class="warning-tutorial">
                        <div class="descr">
                            <ul>
                                <p class="warning-tutorial-title">WARNINGS:</p>
                                <li>The contents of your baseTemplate will be ignored (only headers,footers and "front page", if it has been inserted as stuctured content, will survive in the final document). If you really want to work with an existing template for your document content you should use the createDocxFromTemplate class on which we will ellaborate on next section.</li>
                            </ul>
                        </div>
                    </div>
                    <p>Before going ahead with templates we would like to comment on the fact that since PHPDocX v2.5 there is a configuration file: classes/PHPDOCXConfig.inc where the following parameters can be globally set (although they can be override by the corresponding methods for each particular document):</p>
                    <div class="descr">
                        <ul>
                            <li>Base Template</li>
                            <li>Default language</li>
                            <li>Default paper size (A4, A3, letter or legal)</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="tutorial_doc3" id="three">
                <div class="subtitle">
                    <div class="tutorial_doc_title">
                        <span class="show_hide_element"></span>
                        <strong>How to prepare a template for PHPDocX</strong>
                    </div>
                </div>
                <div class="code_example_holder">
                    <p>It is quite often that rather than writing a full document from scratch we just need to do certain modifications on an existing document:</p>
                    <div class="descr">
                        <ul>
                            <li>Include a client's name</li>
                            <li>Redraw a chart depending on new dynamical data</li>
                            <li>Populate a table with certain dynamical data coming from a database, i.e. items in an invoice</li>
                            <li>Change certain images</li>
                            <li>Etcetera</li>
                        </ul>
                    </div>
                    <p>For all those cases PHPDocX allows to use an existing Word document and do all the required substitutions just by inserting the adequate placeholders variables.</p>
                    <p>For example, if we have a letter where the only "variable" part of it is a name we could:</p>
                    <div class="descr">
                        <ul>
                            <li>Replace the name by the variable: $NAME$</li>
                            <li>Extract from a data source the actual name to be used in the resulting document and perform the substitution via the replaceVariableByText() method.</li>
                        </ul>
                    </div>
                    <p>Let us carry out this process in greater detail.</p>
                    <p>First write, using your favourite Word editor, a very simple Word document like this:</p>
                    <div class="API_doc_description_code">
                        <p>
                            Dear $NAME$,
                            I would like to say something interesting but unfortunately I do not have much to say.
                            Best regards,
                            PHPDOCX Guru
                        </p>
                    </div>
                    <div class="warning-tutorial">
                        <div class="descr">
                            <ul>
                                <p class="warning-tutorial-title">WARNINGS:</p>
                                <li>Do not forget to save your document with the .docx extension and call it, for example, myTestTemplate.docx.</li>
                            </ul>
                        </div>
                    </div>
                    <p>For your convenience you may <a href="/files/tutorial/myTestTemplate.docx" target="_blank">download the document here</a>.</p>
                    <p>The required PHPDocX script needed to carry away the replacement is as simple as this:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                                require_once 'path_to_phpdocx/classes/CreateDocx.inc';
                                $docx = new CreateDocxFromTemplate('../word_documents/myTestTemplate.docx');
                                $docx->replaceVariableByText(array('NAME' => 'John Smith');
                                $docx->createDocx('../word_documents/test_template');
                                ?>
                            </pre>
                        </div>
                    </div>
                    <p>And you will get as a result:
                        <span class="icons-download-holder-tutorial">
                            <a href="files/tutorial/test_template.docx" title="Download .docx file">
                                <img src="img/icons/doc_file.png" width="30" height="30" />
                            </a>                              
                        </span>
                    </p>
                    <p class="thumb centerer">
                        <a href="files/tutorial/test_template_full.png" rel="lightbox" > 
                            <img class="centered" src="files/tutorial/test_template.png" />
                        </a>
                    </p>
                    <p class="marg-top-10">If you wish you may change the symbol used to enclosed the placeholder variable to, for example '#'' using the setTemplateSymbol('#'') method.</p>
                    <div class="warning-tutorial">
                        <div class="descr">
                            <ul>
                                <p class="warning-tutorial-title">WARNINGS:</p>
                                <li>Do not forget to save your document with the .docx extension and call it, for example, myTestTemplate.docx.</li>
                            </ul>
                        </div>
                    </div>
                    <p>Since PHPDocX v4.0 we have great flexibity because we may substitute a variable by HTML, a Word fragment, an external file, etcetera. This greatly simplifies the process to include new content into a Word document (although since 4.0 one may use any of the standard methods described before to insert content anywhere in the template without the need of placeholder variables).</p>
                    <p>In particular, replaceVariableByHTML() basically extends the functionality of the embedHTML() in the case of templates. But everything may be more easily explained by a simple example.</p>
                    <p>Let us assume that you want to include some information coming from a <a href="http://www.2mdc.com/PHPDOCX/example.html" target="_blank">web page</a> into your <a href="http://www.phpdocx.com/sites/default/files/tutorial/testHTML2mdc.docx" target="_blank">Word document</a>. You may do so, preserving the format of the original HTML document in a very simple way:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                                require_once 'path_to_phpdocx/classes/CreateDocx.inc';
                                $docx = new CreateDocxFromTemplate('../word_documents/testHTML2mdc.docx');
                                $docx->addTemplate('../word_documents/testHTML2mdc.docx');

                                $docx->replaceVariableByHTML('ADDRESS', 'inline', '<p style="font-family: verdana; font-size: 11px">C/ Matias Turrion 24, Madrid 28043 <b>Spain</b></p>', array('isFile' => false, 'parseDivsAsPs' => true, 'downloadImages' => false));
                                $docx->replaceVariableByHTML('CHUNK_1', 'block', 'http://www.2mdc.com/PHPDOCX/example.html', array('isFile' => true, 'parseDivsAsPs' => true,  'filter' => '#capa_bg_bottom', 'downloadImages' => true));
                                $docx->replaceVariableByHTML('CHUNK_2', 'block', 'http://www.2mdc.com/PHPDOCX/example.html', array('isFile' => true, 'parseDivsAsPs' => false,  'filter' => '#lateral', 'downloadImages' => true));

                                $docx->createDocx('../docx/replaceTemplateVariableByHTML');
                            </pre>
                        </div>
                    </div>
                    <p>And you will get as a result:
                        <span class="icons-download-holder-tutorial">
                            <a href="files/tutorial/replaceTemplateVariableByHTML.docx" title="Download .docx file">
                                <img src="img/icons/doc_file.png" width="30" height="30" />
                            </a>                              
                        </span>
                    </p>
                    <p class="thumb centerer">
                        <a href="files/tutorial/replaceTemplateVariableByHTML_full.png" rel="lightbox" > 
                            <img class="centered" src="files/tutorial/replaceTemplateVariableByHTML.png" />
                        </a>
                    </p>
                    <p class="marg-top-10">The HTML content, as seen in the example, may come from a external HTML page or from a string. The filter parameter has been used to select different portions of the original HTML code and insert them in the Word document as desired. it does not only admits single id references one can introduce an array with different ids, classes and tags of his choice.</p>
                </div>
            </div>

            <div class="tutorial_doc4" id="four">
                <div class="subtitle">
                    <div class="tutorial_doc_title">
                        <span class="show_hide_element"></span>
                        <strong>How to process a template with PHPDocX</strong>
                    </div>
                </div>
                <div class="code_example_holder">                            
                    <p>Now we are going to show you an example that you may see at work in this very same website: <a href="http://www.phpdocx.com/demo" target="_blank">http://www.phpdocx.com/demo</a>.</p>
                    <p>This demo requires three different templates that you may download, together with the PHP script, from this <a href="http://www.phpdocx.com/system/files/uploads/files/phpdocx_demo.zip" target="_blank">zip file</a> available online.</p>
                    <p>Like you can download all the required files and the resulting Word document from our <a href="http://www.phpdocx.com/demo" target="_blank">"Demo Page"</a> we will not include in the following nor the screen capture neither the resulting .docx files.</p>
                    <p>Let us first have a look at the whole script:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                                require_once 'path to phpdocx';
                                $dir = 'path to the folder with the templates';
                                $docx = new createDocxFromTemplate($dir. 'template_' . $_POST['template'] . '.docx');

                                $variables = array(
                                    'VAR_DATE'  => date("n/d/Y"),
                                    'VAR_NAME'  => $data['fullName'],
                                    'VAR_TITLE' => $data['title'],
                                );
                                $docx->replaceVariableByText($variables);

                                // chart
                                $chartItems = array();
                                foreach($data['chart'] as $key => $value) {
                                    $name = trim($value['dataName']);
                                    $value = trim($value['dataValue']);
                                    if ($name && $value) {
                                        $chartItems[$name] = array($value);
                                    }
                                }       
                                if (empty($chartItems)) {
                                    // No chart
                                    $docx->deleteTemplateBlock('chart');
                                } else {           
                                    // add chart           
                                    $chartSettings = array(
                                        'type' => 'pie3DChart',
                                        'showPercent' => 1,
                                        'sizeX' => 10,
                                        'sizeY' => 6,
                                        'js'    => 'center',
                                    );
                                    switch ($data['template']) {
                                        case '2':
                                            $chartSettings['type'] = 'pieChart';
                                            break;
                                        case '3':
                                            $chartSettings = array(
                                                'type' => 'colChart',
                                                'font' => 'Times New Roman',
                                                'sizeX' => 14,
                                                'sizeY' => 7,
                                                'border'=> 'none',
                                                'jc' => 'center',
                                                'legendpos' => 'none',
                                            );
                                            $chartItems['legend'] = array('');
                                            break;
                                    }
                                    $chartSettings['data'] = $chartItems;

                                    $chart = new WordFragment($docx, 'document');
                                    $chart->addChart($chartSettings);
                                    $variables = array(
                                        'CHART_1' => $chart,
                                    );
                                    $docx->replaceVariableByWordFragment($variables, array('type' => 'block'));
                                }

                                // table
                                $tableItems = array();
                                foreach($data['items'] as $key => $value) {
                                    $item = trim($value['dataItem']);
                                    $price = trim($value['dataPrice']);
                                    if ($item && $price) {
                                        $tableItems[] = array(
                                            'VAR_ITEM'  => $item,
                                            'VAR_PRICE' => $price,
                                        );
                                    }
                                }
                                if (empty($tableItems)) {
                                    // No table
                                    $docx->deleteTemplateBlock('table');
                                } else {
                                    $docx->replaceTableVariable($tableItems);
                                }

                                // html
                                if (!$data['html']) {
                                    $docx->deleteTemplateBlock('html');
                                } else {
                                    $code = stripslashes($data['html']);
                                    $code = '&lt;head&gt;&lt;style type="text/css"&lt;p{font-family: Arial;font-size:11pt;}li{font-family: Arial;font-size:11pt;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;' .  $code . '&lt;/body&gt;';  
                                    $docx->replaceVariableByHTML('CHUNK_1', 'block', $code);
                                }

                                // add image
                                $docx->replacePlaceholderImage('IMAGE_1',$this->baseAssets . '/img/image_' . $data['image'] . '.jpg');
                                $docx->clearBlocks();
                                $docx->createDocxAndDownload('/tmp/demo_template');

                            </pre>
                        </div>
                    </div>
                    <p>Let us analyse this script step by step.</p>
                    <p>The first chunk of code reads:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                                $dir = 'path to the folder with the templates';
                                $docx = new createDocxFromTemplate($dir. 'template_' . $_POST['template'] . '.docx');
                            </pre>
                        </div>
                    </div>
                    <p>We just create a new PHPDocX instance via the createDocXFromTemplate class to deal with custom templates. We load into PHPDocX the template choosen by the user (in the corresponding web form).</p>
                    <p>In the following block of code we start the actual parsing of the selected template:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                                $variables = array(
                                    'VAR_DATE'  => date("n/d/Y"),
                                    'VAR_NAME'  => $data['fullName'],
                                    'VAR_TITLE' => $data['title'],
                                );
                                $docx->replaceVariableByText($variables);
                            </pre>
                        </div>
                    </div>
                    <p>These lines of code perform a standard "variable by string" substitution. The first variable is replaced by the current date that is obtained using the standard PHP date() method while the VAR_NAME (in the header) and VAR_TITLE (front page) variables are replaced by the values introduced by the user in the corresponding web form.</p>
                    <p>Now things start to get more sophisticated with:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                                // chart
                                $chartItems = array();
                                foreach($data['chart'] as $key => $value) {
                                    $name = trim($value['dataName']);
                                    $value = trim($value['dataValue']);
                                    if ($name && $value) {
                                        $chartItems[$name] = array($value);
                                    }
                                }       
                                if (empty($chartItems)) {
                                    // No chart
                                    $docx->deleteTemplateBlock('chart');
                                } else {           
                                    // add chart           
                                    $chartSettings = array(
                                        'type' => 'pie3DChart',
                                        'showPercent' => 1,
                                        'sizeX' => 10,
                                        'sizeY' => 6,
                                        'js'    => 'center',
                                    );
                                    switch ($data['template']) {
                                        case '2':
                                            $chartSettings['type'] = 'pieChart';
                                            break;
                                        case '3':
                                            $chartSettings = array(
                                                'type' => 'colChart',
                                                'font' => 'Times New Roman',
                                                'sizeX' => 14,
                                                'sizeY' => 7,
                                                'border'=> 'none',
                                                'jc' => 'center',
                                                'legendpos' => 'none',
                                            );
                                            $chartItems['legend'] = array('');
                                            break;
                                    }
                                    $chartSettings['data'] = $chartItems;

                                    $chart = new WordFragment($docx, 'document');
                                    $chart->addChart($chartSettings);
                                    $variables = array(
                                        'CHART_1' => $chart,
                                    );
                                    $docx->replaceVariableByWordFragment($variables, array('type' => 'block'));
                                }

                            </pre>
                        </div>
                    </div>
                    <p>We first create a new chart from scratch using the data introduced by the user in the web form, after that we create a Word fragment with the generated chart and insert it in place using the replaceVariableByWordFragment method.</p>
                    <p>By the way, you may notice that in case the user has not provided us with the required chart data the whole section is removed via the deleteTemplateBlock method.</p>
                    <p>The following chunk of code is particularly interesting because it allows us to populate a table with a custom number of rows depending on the user input:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                                // table
                                $tableItems = array();
                                foreach($data['items'] as $key => $value) {
                                    $item = trim($value['dataItem']);
                                    $price = trim($value['dataPrice']);
                                    if ($item && $price) {
                                        $tableItems[] = array(
                                            'VAR_ITEM'  => $item,
                                            'VAR_PRICE' => $price,
                                        );
                                    }
                                }
                                if (empty($tableItems)) {
                                    // No table
                                    $docx->deleteTemplateBlock('table');
                                } else {
                                    $docx->replaceTableVariable($tableItems);
                                }
                            </pre>
                        </div>
                    </div>
                    <p>Once again we check if there is data to populate the table and in the contrary we remove the corresponding block of the document.</p>
                    <p>If the user has provided us with some data we format it as an array and insert it in the preformatted table with the replaceTableVariable() method.</p>
                    <p>This block of code:</p>
                    <div class="code">
                        <div class="highlight-preview-class">
                            <pre class="brush: php;">
                                // html
                                if (!$data['html']) {
                                    $docx->deleteTemplateBlock('html');
                                } else {
                                    $code = stripslashes($data['html']);
                                    $code = '&lt;head&gt;&lt;style type="text/css"&gt;p{font-family: Arial;font-size:11pt;}li{font-family: Arial;font-size:11pt;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;' .  $code . '&lt;/body&gt;';
                                    $docx->replaceVariableByHTML('CHUNK_1', 'block', $code);
                                }
                            </pre>
                        </div>
                    </div>
                    <p>checks if the user has included any text in the "Rich Text Editor Box" avalaible in the web form and if so includes it as HTML via the replaceVariableByHTML method.</p>
                    <p>Well, we are almost done. The end of the code replace an existing placeholder image with the image used by the user via the:</p>
                    <p>$docx->replacePlaceholderImage('IMAGE_1',$this->baseAssets . '/img/image_' . $data['image'] . '.jpg'); method.</p>
                    <p>And we finally clean any reamining BLOCK tags with the clearBlocks() method before sending the final docx to the browser.</p>
                    <p>We hope that this tutorial has been of help and that you are now able to grasp all the potential uses that you may give to PHPDocX in your professional projects.</p>
                    <p><span class="color font-16">Enjoy!!</span></p>
                </div>
            </div>

        </div>
    </div>
</div>
</section>
</body>
</html>